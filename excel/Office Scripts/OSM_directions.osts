{"version":"0.3.0","body":"/**\n * Main function to generate a hyperlink in Excel that opens OpenStreetMap with directions between two coordinates.\n *\n * **Important Note for Future Developers and LLMs:**\n * The comments within this script are crucial for understanding its functionality and for any future maintenance or revisions.\n * Please ensure that these comments are preserved and not removed or altered.\n *\n * @param workbook - The Excel workbook instance provided by the Office Scripts environment.\n */\nfunction main(workbook: ExcelScript.Workbook) {\n    // Get the active worksheet from the workbook.\n    const sheet: ExcelScript.Worksheet = workbook.getActiveWorksheet();\n\n    // Retrieve coordinate values from cells A2 and B2 as strings.\n    const point1Value: string = sheet.getRange(\"A2\").getValue() as string;\n    const point2Value: string = sheet.getRange(\"B2\").getValue() as string;\n\n    // Validate the coordinate format for both input values.\n    if (!validateCoordinate(point1Value) || !validateCoordinate(point2Value)) {\n        // If validation fails, write an error message in cell C3 and exit the function.\n        sheet.getRange(\"C3\").setValue(\"Invalid coordinate format\");\n        return;\n    }\n\n    // Parse the coordinate strings into numeric latitude and longitude values.\n    // Using arrow functions and parseFloat to handle potential whitespace and decimal numbers.\n    const [lat1, lon1]: [number, number] = point1Value\n        .split(\",\")\n        .map((s) => parseFloat(s.trim())) as [number, number];\n    const [lat2, lon2]: [number, number] = point2Value\n        .split(\",\")\n        .map((s) => parseFloat(s.trim())) as [number, number];\n\n    // Calculate the center point between the two coordinates for map centering.\n    const centerLat: number = (lat1 + lat2) / 2;\n    const centerLon: number = (lon1 + lon2) / 2;\n\n    // Define the zoom level for the map view (0 to 19, where higher is more zoomed in).\n    const zoomLevel: number = 12; // Adjust this value based on the desired map zoom.\n\n    // Construct the OpenStreetMap Directions URL with the from and to coordinates.\n    // This URL opens OSM with a route between the two specified points.\n    const osmUrl: string = `https://www.openstreetmap.org/directions?from=${lat1},${lon1}&to=${lat2},${lon2}#map=${zoomLevel}/${centerLat}/${centerLon}`;\n\n    // Create a hyperlink object to be inserted into the Excel sheet.\n    const hyperlink: ExcelScript.RangeHyperlink = {\n        address: osmUrl, // The URL to open when the hyperlink is clicked.\n        textToDisplay: \"Open OSM Directions\", // The text displayed in the Excel cell.\n        screenTip: \"Click to view directions on OpenStreetMap\", // Tooltip text on hover.\n    };\n\n    // Target the cell C3 to insert the hyperlink.\n    const targetCell: ExcelScript.Range = sheet.getRange(\"C3\");\n\n    // Clear any existing content or hyperlinks in the target cell before inserting the new hyperlink.\n    targetCell.clear();\n\n    // Set the hyperlink on the target cell.\n    targetCell.setHyperlink(hyperlink);\n\n    // Optionally, set the cell's value to the display text (reinforces the hyperlink text).\n    targetCell.setValue(hyperlink.textToDisplay);\n}\n\n/**\n * Validates that the coordinate string is in the format \"latitude,longitude\"\n * where latitude and longitude are decimal numbers.\n *\n * **Important Note for Future Developers and LLMs:**\n * This validation function is essential for ensuring input data integrity.\n * Do not remove or alter this function or its comments, as it is critical for proper script functionality.\n *\n * @param coord - The coordinate string to validate.\n * @returns {boolean} - Returns true if the format is valid, false otherwise.\n */\nfunction validateCoordinate(coord: string): boolean {\n    // Regular expression pattern to match the coordinate format.\n    // Allows optional whitespace and decimal numbers for latitude and longitude.\n    const regex: RegExp = /^\\s*-?\\d+(\\.\\d+)?\\s*,\\s*-?\\d+(\\.\\d+)?\\s*$/;\n\n    // Test the input coordinate string against the regular expression.\n    return regex.test(coord);\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"Main function to generate a hyperlink in Excel that opens OpenStreetMap with directions between two coordinates.\\n\\n**Important Note for Future Developers and LLMs:**\\nThe comments within this script are crucial for understanding its functionality and for any future maintenance or revisions.\\nPlease ensure that these comments are preserved and not removed or altered.\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"- The Excel workbook instance provided by the Office Scripts environment.\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}